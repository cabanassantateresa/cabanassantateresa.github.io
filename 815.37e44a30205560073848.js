(self.webpackChunkcst_frontend=self.webpackChunkcst_frontend||[]).push([[815],{3815:(t,e,n)=>{"use strict";n.r(e),n.d(e,{AvailabilityModule:()=>Z});var a=n(1116),i=n(3319),r=n(932),s=n(8619),o=n(8870),c=n(2695);function l(t,e){if(1&t&&(s.TgZ(0,"td"),s._uU(1),s.ALo(2,"date"),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Oqu(s.xi3(2,1,t.date,"dd/MM/yyyy"))}}function d(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",15),s.NdJ("click",function(){s.CHM(t);const e=s.oxw().$implicit;return s.oxw().showReservations(e)}),s._uU(1,"Ver"),s.qZA()}}function u(t,e){if(1&t&&(s.TgZ(0,"td"),s.TgZ(1,"div",2),s.TgZ(2,"div",13),s._uU(3),s.qZA(),s.YNc(4,d,2,0,"button",14),s.qZA(),s.qZA()),2&t){const t=e.$implicit;s.xp6(3),s.hij(" ",t.bookings.length," "),s.xp6(1),s.Q6J("ngIf",t.bookings.length>0)}}function h(t,e){if(1&t&&(s.TgZ(0,"td"),s._uU(1),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Oqu(t.availables)}}let b=(()=>{class t{constructor(t,e,n,a,i){this.router=t,this.activated=e,this.reservationsS=n,this.alerts=a,this.datePipe=i,this.getCurrentDate=r.Ux,this.transformDate=r.Mu,localStorage.setItem("currentRoute","availability"),(this.currentDate=this.activated.snapshot.params.DATE)||(this.currentDate=(0,r.Ux)()),this.consulters=[{ob:this.reservationsS.getWeek(this.currentDate),cb:t=>this.week=t}],this.alerts.showLoadingConsults(this.consulters.map(t=>t.ob),this.consulters.map(t=>t.cb))}ngOnInit(){}prevDay(){this.router.navigate(["/dashboard/availability",this.currentDate=(0,r.Mu)(this.currentDate,-1)]),this.updateWeek()}nextDay(){this.router.navigate(["/dashboard/availability",this.currentDate=(0,r.Mu)(this.currentDate,1)]),this.updateWeek()}pickDay(t){this.router.navigate(["/dashboard/availability",this.currentDate=t.target.value]),this.updateWeek()}updateWeek(){this.consulters[0].ob=this.reservationsS.getWeek(this.currentDate);let t=this.consulters[0];this.alerts.showLoadingConsult(t.ob,t.cb)}showReservations(t){var e;let n=[],a=t.bookings.map(t=>{let e=document.createElement("button");return e.classList.add("btn","btn-sm","btn-info"),e.onclick=()=>this.router.navigate(["/dashboard/reservations",t.id,"details"]),e.innerText="Ver",n.push(e),`\n        <tr>\n          <td>${t.name} ${t.surname}</td>\n          <td>${t.cab_quantity}</td>\n          <td class="btn-details-cst"></td>\n        </tr>`}),i=document.createElement("div");i.innerHTML=`\n    <div class="table-responsive">\n        <table class="table table-bordered">\n            <thead>\n                <tr>\n                    <th>Titular</th>\n                    <th>Caba\xf1as</th>\n                    <th></th>\n                </tr>\n            </thead>\n            <tbody>${a}</tbody>\n        </table>\n    </div>`;let r=i.getElementsByClassName("btn-details-cst");for(let s=0;s<r.length;s++)null===(e=r.item(s))||void 0===e||e.append(n[s]);this.alerts.showModal(this.datePipe.transform(new Date(t.date),"dd/MM/yyyy"),i)}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(i.F0),s.Y36(i.gz),s.Y36(o.E),s.Y36(c.m),s.Y36(a.uU))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-availability"]],decls:29,vars:4,consts:[[1,"card"],[1,"card-body"],[1,"btn-group"],[1,"btn","btn-secondary",3,"click"],["aria-hidden","true",1,"fa","fa-angle-left"],[1,"btn","btn-primary",3,"click"],["aria-hidden","true",1,"fa","fa-angle-right"],["routerLink","/dashboard/availability",1,"btn","btn-primary"],["type","date",1,"form-control",3,"value","change"],[1,"table-responsive"],[1,"table","table-bordered"],[1,"text-center"],[4,"ngFor","ngForOf"],[1,"form-control","form-control-sm"],["class","btn btn-sm btn-info",3,"click",4,"ngIf"],[1,"btn","btn-sm","btn-info",3,"click"]],template:function(t,e){1&t&&(s.TgZ(0,"h2"),s._uU(1,"Disponibilidad"),s.qZA(),s._UZ(2,"hr"),s.TgZ(3,"div",0),s.TgZ(4,"div",1),s.TgZ(5,"div",2),s.TgZ(6,"a",3),s.NdJ("click",function(){return e.prevDay()}),s._UZ(7,"i",4),s.qZA(),s.TgZ(8,"a",5),s.NdJ("click",function(){return e.nextDay()}),s._UZ(9,"i",6),s.qZA(),s.TgZ(10,"a",7),s._uU(11,"Hoy"),s.qZA(),s.TgZ(12,"input",8),s.NdJ("change",function(t){return e.pickDay(t)}),s.qZA(),s.qZA(),s._UZ(13,"hr"),s.TgZ(14,"div",9),s.TgZ(15,"table",10),s.TgZ(16,"tbody"),s.TgZ(17,"tr",11),s.TgZ(18,"th"),s._uU(19,"D\xedas"),s.qZA(),s.YNc(20,l,3,4,"td",12),s.qZA(),s.TgZ(21,"tr",11),s.TgZ(22,"th"),s._uU(23,"Reservas"),s.qZA(),s.YNc(24,u,5,2,"td",12),s.qZA(),s.TgZ(25,"tr",11),s.TgZ(26,"th"),s._uU(27,"Disponibles"),s.qZA(),s.YNc(28,h,2,1,"td",12),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA()),2&t&&(s.xp6(12),s.Q6J("value",e.currentDate),s.xp6(8),s.Q6J("ngForOf",e.week),s.xp6(4),s.Q6J("ngForOf",e.week),s.xp6(4),s.Q6J("ngForOf",e.week))},directives:[i.yS,a.sg,a.O5],pipes:[a.uU],styles:[""]}),t})();const p=[{path:"",component:b},{path:":DATE",component:b}];let g=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.oAB({type:t}),t.\u0275inj=s.cJS({imports:[[i.Bz.forChild(p)],i.Bz]}),t})(),Z=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.oAB({type:t}),t.\u0275inj=s.cJS({providers:[a.uU],imports:[[a.ez,g]]}),t})()}}]);